<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A crash course on gravity models • gravity</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A crash course on gravity models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gravity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/crash-course-on-gravity-models.html">A crash course on gravity models</a></li>
    <li><a class="dropdown-item" href="../articles/creating-gravity-datasets.html">Creating gravity datasets</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pachadotdev/gravity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="crash-course-on-gravity-models_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A crash course on gravity models</h1>
                        <h4 data-toc-skip class="author">Mauricio Vargas</h4>
            
            <h4 data-toc-skip class="date">2024-11-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pachadotdev/gravity/blob/HEAD/vignettes/crash-course-on-gravity-models.Rmd" class="external-link"><code>vignettes/crash-course-on-gravity-models.Rmd</code></a></small>
      <div class="d-none name"><code>crash-course-on-gravity-models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basic-model">Basic model<a class="anchor" aria-label="anchor" href="#basic-model"></a>
</h2>
<p>Gravity models in their traditional form are inspired by Newton law of gravitation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>G</mi><mfrac><mrow><msub><mi>M</mi><mi>i</mi></msub><msub><mi>M</mi><mi>j</mi></msub></mrow><msubsup><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
F_{ij}=G\frac{M_{i}M_{j}}{D^{2}_{ij}}.
</annotation></semantics></math></p>
<p>The force <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> between two bodies <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i \neq j</annotation></semantics></math> is proportional to the masses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> of these bodies and inversely proportional to the square of their geographical distance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math> is a constant and as such of no major concern.</p>
<p>The underlying idea of a traditional gravity model, shown for international trade, is equally simple:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>G</mi><mfrac><mrow><msubsup><mi>Y</mi><mi>i</mi><msub><mi>β</mi><mn>1</mn></msub></msubsup><msubsup><mi>Y</mi><mi>j</mi><msub><mi>β</mi><mn>2</mn></msub></msubsup></mrow><msubsup><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow><msub><mi>β</mi><mn>3</mn></msub></msubsup></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
X_{ij}=G\frac{Y_{i}^{\beta_{1}}Y_{j}^{\beta_{2}}}{D_{ij}^{\beta_{3}}}.
</annotation></semantics></math></p>
<p>The trade flow <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> is explained by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_{i}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">Y_{j}</annotation></semantics></math> that are the masses of the exporting and importing country (e.g. the GDP) and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math> that is the distance between the countries.</p>
<p>Dummy variables such as common borders <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">contig</annotation></semantics></math> or regional trade agreements <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">rta</annotation></semantics></math> can be added to the model. Let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">t_{ij}</annotation></semantics></math> be the transaction cost defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>exp</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>i</mi><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><mi>r</mi><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
t_{ij}= D_{ij} \exp(contig_{ij} + rta_{ij})
</annotation></semantics></math></p>
<p>So that the model with friction becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>G</mi><mfrac><mrow><msubsup><mi>Y</mi><mi>i</mi><msub><mi>β</mi><mn>1</mn></msub></msubsup><msubsup><mi>Y</mi><mi>j</mi><msub><mi>β</mi><mn>2</mn></msub></msubsup></mrow><msubsup><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow><msub><mi>β</mi><mn>3</mn></msub></msubsup></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
X_{ij}=G\frac{Y_{i}^{\beta_{1}}Y_{j}^{\beta_{2}}}{t_{ij}^{\beta_{3}}}.
</annotation></semantics></math></p>
<p>A logarithmic operator can be applied to form a log-linear model and use a standard estimation methods such as OLS:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>log</mo><mi>G</mi><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mo>log</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>log</mo><msub><mi>Y</mi><mi>j</mi></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mo>log</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>4</mn></msub><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>i</mi><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>5</mn></msub><mi>r</mi><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\log X_{ij}=\beta_{0}\log G +\beta_{1}\log Y_{i}+\beta_{2}\log Y_{j}+\beta_{3}\log D_{ij}+\beta_{4}contig_{ij}+\beta_{5}rta_{ij}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="trade-barriers-model">Trade barriers model<a class="anchor" aria-label="anchor" href="#trade-barriers-model"></a>
</h2>
<p>Provided trade barriers exists, the econometric literature proposes the Multilateral Resistance model defined by the equations:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>Y</mi><mi>i</mi></msub><msub><mi>Y</mi><mi>j</mi></msub></mrow><mi>Y</mi></mfrac><mfrac><msubsup><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><mrow><msubsup><mi>P</mi><mi>j</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><msubsup><mi>Π</mi><mi>i</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
X_{ij}=\frac{Y_{i}Y_{j}}{Y}\frac{t_{ij}^{1-\sigma}}{P_{j}^{1-\sigma}\Pi_{i}^{1-\sigma}}
</annotation></semantics></math> with <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mfrac><msubsup><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><msubsup><mi>Π</mi><mi>j</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup></mfrac><mfrac><msub><mi>Y</mi><mi>j</mi></msub><mi>Y</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
P_{i}^{1-\sigma}=\sum_{j}\frac{t_{ij}^{1-\sigma}}{\Pi_{j}^{1-\sigma}}\frac{Y_{j}}{Y}.
</annotation></semantics></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Π</mi><mi>j</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mfrac><msubsup><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup><msubsup><mi>P</mi><mi>i</mi><mrow><mn>1</mn><mo>−</mo><mi>σ</mi></mrow></msubsup></mfrac><mfrac><msub><mi>Y</mi><mi>i</mi></msub><mi>Y</mi></mfrac></mrow><annotation encoding="application/x-tex">
\Pi_{j}^{1-\sigma}=\sum_{i}\frac{t_{ij}^{1-\sigma}}{P_{i}^{1-\sigma}}\frac{Y_{i}}{Y}
</annotation></semantics></math></p>
<p>Basically the model proposes that the exports <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{ij}</annotation></semantics></math> from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> are determined by the supply factors in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_{i}</annotation></semantics></math>, and the demand factors in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">Y_{j}</annotation></semantics></math>, as well as the transaction costs <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">t_{ij}</annotation></semantics></math>.</p>
<p>Next to information on bilateral partners <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>, information on the rest of the world is included in the gravity model with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">Y=\sum_{i} Y_{i}= \sum_{j} Y_{j}</annotation></semantics></math> that represents the worldwide sum of incomes (e.g. the world’s GDP).</p>
<p>In this model <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> represents the elasticity of substitution between all goods. A key assumption is to take a fixed value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma &gt; 1</annotation></semantics></math> in order to account for the preference for a variation of goods (e.g. in this model goods can be replaced for other similar goods).</p>
<p>The Multilateral Resistance terms are included via the terms <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>, Inward Multilateral Resistance, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Π</mi><annotation encoding="application/x-tex">\Pi</annotation></semantics></math>, Outward Multilateral Resistance. The Inward Multilateral Resistance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>i</mi></msub><annotation encoding="application/x-tex">P_i</annotation></semantics></math> is a function of the transaction costs of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> to all trade partners <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>. The Outward Multilateral Resistance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Π</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\Pi_{j}</annotation></semantics></math> is a function of the transaction costs of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> to all trade partners <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and their demand.</p>
<p>The Multilateral Resistance terms dependent on each other. Hence, the estimation of structural gravity models becomes complex.</p>
</div>
<div class="section level2">
<h2 id="model-estimation">Model estimation<a class="anchor" aria-label="anchor" href="#model-estimation"></a>
</h2>
<p>To estimate gravity equations you need a square dataset including bilateral flows defined by the argument dependent_variable, a distance measure defined by the argument distance that is the key regressor, and other potential influences (e.g. contiguity and common currency) given as a vector in additional_regressors are required.</p>
<p>Some estimation methods require ISO codes or similar of type character variables to compute particular country effects. Make sure the origin and destination codes are of type “character”.</p>
<p>The rule of thumb for regressors or independent variables consists in:</p>
<ul>
<li>All dummy variables should be of type numeric (0/1).</li>
<li>If an independent variable is defined as a ratio, it should be logged.</li>
</ul>
<p>The user should perform some data cleaning beforehand to remove observations that contain entries that can distort estimates, notwithstanding the functions provided within this package will remove zero flows and distances.</p>
<p>See  for gravity datasets and Stata code for estimating gravity models.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>All the examples here are adapted from <span class="citation">Wölwer, Breßlein, and Burgard (2018)</span>. We included some examples that require further explanation as they perform some data transforming and therefore the functions provide a simplification for the end user.</p>
<div class="section level3">
<h3 id="double-demeaning">Double Demeaning<a class="anchor" aria-label="anchor" href="#double-demeaning"></a>
</h3>
<p>Double Demeaning, as introduced by <span class="citation">Head and Mayer (2014)</span>, subtracts importer and exporter averages on the left and right hand side of the respective gravity equation, and all unilateral influences including the Multilateral Resistance terms vanish. Therefore, no unilateral variables may be added as independent variables for the estimation.</p>
<p>Our ddm function first logs the dependent variable and the distance variable. Afterwards, the dependent and independent variables are transformed in the following way (exemplary shown for trade flows, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{ij}</annotation></semantics></math>):</p>
<p><span class="math display">$$
(\log X_{ij})_{\text{DDM}} = (\log X_{ij}) - (\log X_{ij})_{\text{Origin Mean}} \\- (\log X_{ij})_{\text{Destination Mean}} + (\log X_{ij})_{\text{Mean}}.
$$</span></p>
<p>One subtracts the mean value for the origin country and the mean value for the destination country and adds the overall mean value to the logged trade flows. This procedure is repeated for all dependent and independent variables. The transformed variables are then used for the estimation.</p>
<p>DDM is easily applied, but, as shown in , its very sensitive to missing data.</p>
<p>An example of how to apply the function ddm to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pacha.dev/gravity/" class="external-link">gravity</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddm.html">ddm</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  code_origin <span class="op">=</span> <span class="st">"iso_o"</span>,</span>
<span>  code_destination <span class="op">=</span> <span class="st">"iso_d"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_log_ddm ~ dist_log_ddm + rta_ddm + comcur_ddm + contig_ddm + </span></span>
<span><span class="co">##     0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -20.9411  -1.2268   0.3032   1.5195   8.4538 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## dist_log_ddm -1.60334    0.03312 -48.407   &lt;2e-16 ***</span></span>
<span><span class="co">## rta_ddm       0.79727    0.07004  11.383   &lt;2e-16 ***</span></span>
<span><span class="co">## comcur_ddm    0.17376    0.14613   1.189    0.234    </span></span>
<span><span class="co">## contig_ddm    1.00184    0.11981   8.362   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.318 on 17084 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2541, Adjusted R-squared:  0.254 </span></span>
<span><span class="co">## F-statistic:  1455 on 4 and 17084 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>The package returns lm or glm objects instead of summaries. Doing that allows to use our functions in conjunction with broom or other packages.</p>
</div>
<div class="section level3">
<h3 id="bonus-vetus">Bonus Vetus<a class="anchor" aria-label="anchor" href="#bonus-vetus"></a>
</h3>
<p><span class="citation">Baier and Bergstrand (2010)</span> suggests a modification of the simple OLS that is easily implemented, allows for comparative statics and yields results close to those of NLS, called Bonus vetus OLS (BVU and BVW). They estimate gravity models in their additive form.</p>
<p>As unilateral income elasticities are assumed, flows are divided by the product of unilateral incomes. The dependent variable for the estimation is therefore <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>y</mi><mrow><mi>i</mi><mi>n</mi><msub><mi>c</mi><mi>o</mi></msub><mspace width="0.222em"></mspace><mi>i</mi><mi>n</mi><msub><mi>c</mi><mi>d</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\log\left(\frac{y}{inc_{o} \: inc_{d}}\right).</annotation></semantics></math></p>
<p>By applying a Taylor-series expansion and the assumption of symmetrical, bilateral trade costs, they develop a reduced gravity model in which multilateral and worldwide resistance enter exogenously.</p>
<p><span class="citation">Baier and Bergstrand (2010)</span> distinguishes two types of Bonus vetus estimations depending on how the Taylor-series is centered. One method, called BVU, uses simple averages while the other, called BVW, uses GDP weights. Depending on which method is used, the transaction costs are weighted differently. For advantages and disadvantages of both methods see <span class="citation">Baier and Bergstrand (2009)</span> and <span class="citation">Baier and Bergstrand (2010)</span>.</p>
<p>To give an example with simple averages (BVU), distance would be transformed to Multilateral and World Resistance in the following way: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>W</mi><msub><mi>R</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msup><mi>N</mi><mn>2</mn></msup></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
MWR_{ij} = \frac{1}{N}\left(\sum_{i=1}^{N}\log D_{ij} \right)+\frac{1}{N}\left(\sum_{j=1}^{N}\log D_{ij} \right)-\frac{1}{N^{2}}\left(\sum_{i=1}^{N}\sum_{j=1}^{N}\log D_{ij} \right)
</annotation></semantics></math> with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math> denoting the bilateral distance, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> the number of countries and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>M</mi><mi>W</mi><mi>R</mi><msub><mo stretchy="false" form="postfix">)</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msub></mrow><annotation encoding="application/x-tex">(MWR)_{D_{ij}}</annotation></semantics></math> the transformed variable adjusted for multilateral resistances.</p>
<p>When using weighted averages (BVW), the simple averages are replaced by GDP weights. The transformed variables are included as independent variables in the estimation. The resulting equation can be estimated by simple OLS.</p>
<p>An example of how to apply the functions <code>bvu</code> and <code>bvw</code> to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvu.html">bvu</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"contig"</span>, <span class="st">"comcur"</span><span class="op">)</span>,</span>
<span>  income_origin <span class="op">=</span> <span class="st">"gdp_o"</span>,</span>
<span>  income_destination <span class="op">=</span> <span class="st">"gdp_d"</span>,</span>
<span>  code_origin <span class="op">=</span> <span class="st">"iso_o"</span>,</span>
<span>  code_destination <span class="op">=</span> <span class="st">"iso_d"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_log_bvu ~ dist_log_mr + rta_mr + contig_mr + comcur_mr</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -20.0642  -1.2305   0.2932   1.5810   9.6659 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error   t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -20.15771    0.01919 -1050.573  &lt; 2e-16 ***</span></span>
<span><span class="co">## dist_log_mr  -1.68697    0.03586   -47.048  &lt; 2e-16 ***</span></span>
<span><span class="co">## rta_mr        0.58230    0.07926     7.347 2.12e-13 ***</span></span>
<span><span class="co">## contig_mr     1.00135    0.13148     7.616 2.75e-14 ***</span></span>
<span><span class="co">## comcur_mr     0.19102    0.16727     1.142    0.253    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.508 on 17083 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2294, Adjusted R-squared:  0.2292 </span></span>
<span><span class="co">## F-statistic:  1271 on 4 and 17083 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvw.html">bvw</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  income_origin <span class="op">=</span> <span class="st">"gdp_o"</span>,</span>
<span>  income_destination <span class="op">=</span> <span class="st">"gdp_d"</span>,</span>
<span>  code_origin <span class="op">=</span> <span class="st">"iso_o"</span>,</span>
<span>  code_destination <span class="op">=</span> <span class="st">"iso_d"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_log_bvw ~ dist_log_mr + rta_mr + comcur_mr + contig_mr</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -19.1204  -1.3366   0.4068   1.7068  10.6927 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -20.37260    0.05458 -373.27  &lt; 2e-16 ***</span></span>
<span><span class="co">## dist_log_mr  -0.63445    0.02566  -24.73  &lt; 2e-16 ***</span></span>
<span><span class="co">## rta_mr        1.30989    0.06703   19.54  &lt; 2e-16 ***</span></span>
<span><span class="co">## comcur_mr    -0.89609    0.14201   -6.31 2.86e-10 ***</span></span>
<span><span class="co">## contig_mr     1.37696    0.12606   10.92  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.683 on 17083 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.1185, Adjusted R-squared:  0.1183 </span></span>
<span><span class="co">## F-statistic:   574 on 4 and 17083 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="poisson-pseudo-maximum-likelihood-ppml">Poisson Pseudo Maximum Likelihood (PPML)<a class="anchor" aria-label="anchor" href="#poisson-pseudo-maximum-likelihood-ppml"></a>
</h3>
<p><span class="citation">Silva and Tenreyro (2006)</span> argue that estimating gravity equations in their additive form by OLS leads to inconsistency in the presence of heteroscedasticity and advice to estimate gravity models in their multiplicative form. An example of how to apply the function <code>ppml</code> to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppml.html">ppml</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_ppml ~ dist_log + rta + comcur + contig</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  5.76232    0.77160   7.468 8.54e-14 ***</span></span>
<span><span class="co">## dist_log     0.02428    0.08728   0.278    0.781    </span></span>
<span><span class="co">## rta          1.26582    0.16972   7.458 9.20e-14 ***</span></span>
<span><span class="co">## comcur       1.10604    0.17982   6.151 7.89e-10 ***</span></span>
<span><span class="co">## contig       1.75821    0.18141   9.692  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for quasipoisson family taken to be 42366.31)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 78081855  on 17087  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 61989121  on 17083  degrees of freedom</span></span>
<span><span class="co">## AIC: NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 8</span></span></code></pre>
<p>In order to obtain robust standard errors (i.e. in a similar way to <code>vce(robust)</code> in <em>Stata</em>) you can include <code>robust = T</code> to the arguments:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit4r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppml.html">ppml</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit4r</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_ppml ~ dist_log + rta + comcur + contig</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## [1,]  5.76232    0.77160   7.468 8.54e-14 ***</span></span>
<span><span class="co">## [2,]  0.02428    0.08728   0.278    0.781    </span></span>
<span><span class="co">## [3,]  1.26582    0.16972   7.458 9.20e-14 ***</span></span>
<span><span class="co">## [4,]  1.10604    0.17982   6.151 7.89e-10 ***</span></span>
<span><span class="co">## [5,]  1.75821    0.18141   9.692  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for quasipoisson family taken to be 42366.31)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 78081855  on 17087  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 61989121  on 17083  degrees of freedom</span></span>
<span><span class="co">## AIC: NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 8</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="gamma-pseudo-maximum-likelihood-gpml">Gamma Pseudo Maximum Likelihood (GPML)<a class="anchor" aria-label="anchor" href="#gamma-pseudo-maximum-likelihood-gpml"></a>
</h3>
<p>The estimation method is similar to PPML, but utilizes the gamma instead of the poisson distribution, thereby implies different assumptions to the data structure and does not allow for zero trade values.</p>
<p><span class="citation">Silva and Tenreyro (2006)</span> argue in favor of PPML instead of GPML, especially in case of heteroscedasticity, <span class="citation">Head and Mayer (2014)</span> highlight that depending on data structure there exist cases where GPML is preferable to PPML.</p>
<p>An example of how to apply the function <code>gpml</code> to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gpml.html">gpml</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Estimate         Std. Error        z value          Pr(&gt;|z|)        </span></span>
<span><span class="co">##  Min.   :-0.1613   Min.   :0.1183   Min.   :-1.364   Min.   :0.000e+00  </span></span>
<span><span class="co">##  1st Qu.: 0.7833   1st Qu.:0.1603   1st Qu.: 4.279   1st Qu.:0.000e+00  </span></span>
<span><span class="co">##  Median : 1.0295   Median :0.1831   Median : 5.740   Median :1.000e-08  </span></span>
<span><span class="co">##  Mean   : 2.1508   Mean   :0.3571   Mean   : 4.457   Mean   :3.453e-02  </span></span>
<span><span class="co">##  3rd Qu.: 1.7065   3rd Qu.:0.2973   3rd Qu.: 6.424   3rd Qu.:1.879e-05  </span></span>
<span><span class="co">##  Max.   : 7.3963   Max.   :1.0266   Max.   : 7.205   Max.   :1.726e-01</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="negative-binomial-pseudo-maximum-likelihood-nbpml">Negative Binomial Pseudo Maximum Likelihood (NBPML)<a class="anchor" aria-label="anchor" href="#negative-binomial-pseudo-maximum-likelihood-nbpml"></a>
</h3>
<p>The estimation method is similar to PPML, but utilizes the negative binomial instead of the poisson distribution, thereby implies different assumptions to the data structure and does not allow for zero trade values.</p>
<p>An example of how to apply the function <code>nbpml</code> to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nbpml.html">nbpml</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rta"</span>, <span class="st">"comcur"</span>, <span class="st">"contig"</span><span class="op">)</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Estimate         Std. Error        z value          Pr(&gt;|z|)        </span></span>
<span><span class="co">##  Min.   :-0.1613   Min.   :0.1183   Min.   :-1.364   Min.   :0.000e+00  </span></span>
<span><span class="co">##  1st Qu.: 0.7831   1st Qu.:0.1603   1st Qu.: 4.277   1st Qu.:0.000e+00  </span></span>
<span><span class="co">##  Median : 1.0297   Median :0.1831   Median : 5.739   Median :1.000e-08  </span></span>
<span><span class="co">##  Mean   : 2.1508   Mean   :0.3571   Mean   : 4.457   Mean   :3.454e-02  </span></span>
<span><span class="co">##  3rd Qu.: 1.7064   3rd Qu.:0.2973   3rd Qu.: 6.425   3rd Qu.:1.893e-05  </span></span>
<span><span class="co">##  Max.   : 7.3961   Max.   :1.0266   Max.   : 7.205   Max.   :1.727e-01</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="tetrads">Tetrads<a class="anchor" aria-label="anchor" href="#tetrads"></a>
</h3>
<p>In order to use the fixed effects method with panel data, a huge number of dummy variables has to be included into the estimation. Thus, estimating these models can lead to significant computational difficulties.</p>
<p><span class="citation">Head, Mayer, and Ries (2010)</span> present Tetrads as an estimation method circumventing this problem. They exploit the multiplicative form of the gravity equation to form the ratio of ratios. In doing so, both MR terms drop out of the equation.</p>
<p>An example of how to apply the function <code>tetrads</code> to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tetrads.html">tetrads</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="st">"rta"</span>,</span>
<span>  code_origin <span class="op">=</span> <span class="st">"iso_o"</span>,</span>
<span>  code_destination <span class="op">=</span> <span class="st">"iso_d"</span>,</span>
<span>  filter_origin <span class="op">=</span> <span class="st">"CHN"</span>,</span>
<span>  filter_destination <span class="op">=</span> <span class="st">"USA"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## y_log_rat ~ dist_log_rat + rta_rat</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -21.3989  -1.2542   0.3247   1.5871  10.3864 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  -0.39969    0.02162  -18.49   &lt;2e-16 ***</span></span>
<span><span class="co">## dist_log_rat -1.32417    0.02307  -57.40   &lt;2e-16 ***</span></span>
<span><span class="co">## rta_rat       0.88305    0.05566   15.87   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.77 on 16710 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2537, Adjusted R-squared:  0.2536 </span></span>
<span><span class="co">## F-statistic:  2840 on 2 and 16710 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>In addition to robust standard errors as in the previous examples, in the case of <code>tetrads</code> you can also be interested in computing multiway variance-covariance, an it can be done by adding <code>multiway = T</code> to the arguments:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tetrads.html">tetrads</a></span><span class="op">(</span></span>
<span>  dependent_variable <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"distw"</span>,</span>
<span>  additional_regressors <span class="op">=</span> <span class="st">"rta"</span>,</span>
<span>  code_origin <span class="op">=</span> <span class="st">"iso_o"</span>,</span>
<span>  code_destination <span class="op">=</span> <span class="st">"iso_d"</span>,</span>
<span>  filter_origin <span class="op">=</span> <span class="st">"CHN"</span>,</span>
<span>  filter_destination <span class="op">=</span> <span class="st">"USA"</span>,</span>
<span>  multiway <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gravity_no_zeros</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Estimate         Std. Error         t value            Pr(&gt;|t|)        </span></span>
<span><span class="co">##  Min.   :-1.3242   Min.   :0.02152   Min.   :-53.6833   Min.   :0.000e+00  </span></span>
<span><span class="co">##  1st Qu.:-0.8619   1st Qu.:0.02309   1st Qu.:-36.1287   1st Qu.:1.525e-76  </span></span>
<span><span class="co">##  Median :-0.3997   Median :0.02467   Median :-18.5741   Median :3.049e-76  </span></span>
<span><span class="co">##  Mean   :-0.2803   Mean   :0.03164   Mean   :-18.0460   Mean   :3.701e-73  </span></span>
<span><span class="co">##  3rd Qu.: 0.2417   3rd Qu.:0.03670   3rd Qu.: -0.2273   3rd Qu.:5.552e-73  </span></span>
<span><span class="co">##  Max.   : 0.8830   Max.   :0.04873   Max.   : 18.1195   Max.   :1.110e-72</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-Baier2009">
<p>Baier, Scott L., and Jeffrey H. Bergstrand. 2009. “Bonus Vetus Ols: A Simple Method for Approximating International Trade-Cost Effects Using the Gravity Equation.” <em>Journal of International Economics</em> 77 (1): 77–85. <a href="https://doi.org/10.1016/j.jinteco.2008.10.004" class="external-link">https://doi.org/10.1016/j.jinteco.2008.10.004</a>.</p>
</div>
<div id="ref-Baier2010">
<p>Baier, S. L., and J. H. Bergstrand. 2010. “The Gravity Model in International Trade: Advances and Applications.” In, edited by Peter A. G. van Bergeijk and StevenEditors Brakman. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511762109" class="external-link">https://doi.org/10.1017/CBO9780511762109</a>.</p>
</div>
<div id="ref-Head2014">
<p>Head, Keith, and Thierry Mayer. 2014. “Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.” In <em>Handbook of International Economics</em>, edited by Gita Gopinath, Elhanan Helpman, and Kenneth Rogoff, 4:131–95. Handbook of International Economics. Elsevier. <a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3" class="external-link">https://doi.org/10.1016/B978-0-444-54314-1.00003-3</a>.</p>
</div>
<div id="ref-Head2010">
<p>Head, Keith, Thierry Mayer, and John Ries. 2010. “The Erosion of Colonial Trade Linkages After Independence.” <em>Journal of International Economics</em> 81 (1): 1–14. <a href="https://doi.org/10.1016/j.jinteco.2010.01.002" class="external-link">https://doi.org/10.1016/j.jinteco.2010.01.002</a>.</p>
</div>
<div id="ref-Santos2006">
<p>Silva, J. M. C. Santos, and Silvana Tenreyro. 2006. “The Log of Gravity.” <em>The Review of Economics and Statistics</em> 88 (4): 641–58. <a href="https://doi.org/10.1162/rest.88.4.641" class="external-link">https://doi.org/10.1162/rest.88.4.641</a>.</p>
</div>
<div id="ref-WoelwerBressleinBurgard2018">
<p>Wölwer, Anna-Lena, Martin Breßlein, and Jan Pablo Burgard. 2018. “Gravity Models in R.” <em>Austrian Journal of Statistics</em> 47 (4): 16–35. <a href="https://doi.org/10.17713/ajs.v47i4.688" class="external-link">https://doi.org/10.17713/ajs.v47i4.688</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anna-Lena Woelwer, Jan Pablo Burgard, Joshua Kunst, Mauricio Vargas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
